<main class="main-content">
    <h1 class="page-title">Shareholding</h1>
    <!-- Index Breakdown -->
    <!-- <div class="index-section">
        <div class="index-grid">
            <div class="index-card" *ngFor="let idx of indexStats()" (click)="filterByIndex(idx.index)">
                <div class="index-card-title">{{ idx.index.replace('NIFTY ', '') }}</div>
                <div class="trend-row">
                    <span class="trend-label">Total Stocks</span>
                    <span class="trend-value">{{ idx.total }}</span>
                </div>
                <div class="trend-row">
                    <span class="trend-label">Promoter â†‘</span>
                    <span class="trend-value text-up">{{ idx.promoter_up }}</span>
                </div>
                <div class="trend-row">
                    <span class="trend-label">FII â†‘</span>
                    <span class="trend-value text-up">{{ idx.fii_up }}</span>
                </div>
                <div class="trend-row">
                    <span class="trend-label">DII â†‘</span>
                    <span class="trend-value text-up">{{ idx.dii_up }}</span>
                </div>
                <div class="trend-row">
                    <span class="trend-label">Both â†‘</span>
                    <span class="trend-value text-explosive">{{ idx.both_up }}</span>
                </div>
            </div>
        </div>
    </div> -->

    <!-- Filter Tabs -->
    <div class="filter-tabs">
        <button class="filter-tab" [class.active]="currentFilter() === 'all'" (click)="setFilter('all')"> RECENT
        </button>
        <button class="filter-tab" [class.active]="currentFilter() === 'both-up'" (click)="setFilter('both-up')">ðŸ§  Both
            FII & DII â†‘</button>
        <button class="filter-tab" [class.active]="currentFilter() === 'fii-up'" (click)="setFilter('fii-up')">FII
            Increasing</button>
        <button class="filter-tab" [class.active]="currentFilter() === 'dii-up'" (click)="setFilter('dii-up')">DII
            Increasing</button>
        <button class="filter-tab" [class.active]="currentFilter() === 'promoter-up'"
            (click)="setFilter('promoter-up')">Promoter Increasing</button>
        <button class="filter-tab" [class.active]="currentFilter() === 'fii-down'" (click)="setFilter('fii-down')">FII
            Decreasing</button>
        <button class="filter-tab" [class.active]="currentFilter() === 'dii-down'" (click)="setFilter('dii-down')">DII
            Decreasing</button>
    </div>
    <!-- Stock Table -->
    <table class="table table-hover align-middle">
        <thead class="table-light" style="position: sticky; top: 0; background: #fff; z-index: 2;">
            <tr>
                <!-- <th style="width: 6%;">RANK</th> -->
                <th style="width: 12%;">SYMBOL</th>
                <th style="width: 20%;">INDUSTRY</th>
                <th style="width: 10%;">INDICIES</th>
                <th class="text-center" style="width: 18%;">PROMO Î”</th>
                <th class="text-center" style="width: 18%;">FII Î”</th>
                <th class="text-center" style="width: 18%;">DII Î”</th>
                <th class="text-center" style="width: 15%;">PUBLIC</th>
            </tr>
        </thead>
        <tbody style="height: 600px; overflow-y: auto;">
            <ng-container *ngFor="let stock of filteredShareholdings(); let i = index">
                <tr>
                    <!-- <td class="rank">#{{ i + 1 }}</td> -->
                    <td class="symbol">
                        {{ stock.symbol }}
                        <i *ngIf="stock.isFno" class="bi bi-lightning-fill text-warning" title="F&O Stock"
                            style="font-size: 1.2em;"></i>
                    </td>
                    <td class="small">
                        {{ stock.index }}
                    </td>
                    <td class="industry" title="{{stock.industry}}">
                        {{ stock.industry }}
                        ({{ stock.submissionDate ? stock.submissionDate : (stock.periodEnd ? stock.periodEnd : '') }})
                    </td>
                    <td class="metric-value text-center" [ngClass]="getChangeClass(stock.promoterDiff)">
                        <span class="{{stock.promoterDiff > 0 ? 'text-success fs-6' : 'text-danger fs-6'}}">
                            {{ stock.promoterDiff | number:'1.2-2' }}
                        </span>
                        <span> ({{ stock.promoter}}%) </span>
                    </td>
                    <td class="metric-value text-center" [ngClass]="getChangeClass(stock.fiiDiff)">
                        <span class="{{stock.fiiDiff > 0 ? 'text-success fs-6' : 'text-danger fs-6'}}">
                            {{ stock.fiiDiff | number:'1.2-2' }}
                        </span>
                        <span> ({{ stock.fii}}%) </span>
                    </td>
                    <td class="metric-value text-center" [ngClass]="getChangeClass(stock.diiDiff)">
                        <span class="{{stock.diiDiff > 0 ? 'text-success fs-6' : 'text-danger fs-6'}}">
                            {{ stock.diiDiff | number:'1.2-2' }}
                        </span>
                        <span> ({{ stock.dii}}%) </span>
                    </td>
                    <td class="metric-value text-center">{{ stock.public }}%</td>
                </tr>
            </ng-container>
            <!-- Empty State -->
            <tr *ngIf="filteredShareholdings().length === 0" style="display: table; width: 100%;">
                <td colspan="7" class="text-center">
                    <div style="font-size: 48px; margin-bottom: 16px;">ðŸ“Š</div>
                    <div>No stocks match your filters</div>
                </td>
            </tr>
        </tbody>
    </table>
</main>